/// HTTPTrigger is the trigger invokes user functions when receiving HTTP requests.
///
/// This module was generated from the CustomResourceDefinition at
/// <file:///Users/lucsoft/Developer/infra-hmsys-sys/packages/io.Fission/>.
module io.fission.v1.HTTPTrigger

extends "@k8s/K8sResource.pkl"

import "@k8s/apimachinery/pkg/apis/meta/v1/ObjectMeta.pkl"

fixed apiVersion: "fission.io/v1"

fixed kind: "HTTPTrigger"

/// Standard object's metadata.
///
/// More info: <https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#metadata>.
metadata: ObjectMeta?

/// HTTPTriggerSpec is for router to expose user functions at the given URL path.
spec: Spec

/// HTTPTriggerSpec is for router to expose user functions at the given URL path.
class Spec {
  /// If CreateIngress is true, router will create an ingress definition.
  createingress: Boolean?

  /// FunctionReference is a reference to the target function.
  functionref: Functionref

  /// Deprecated: the original idea of this field is not for setting Ingress. Since we have IngressConfig
  /// now, remove Host after couple releases.
  host: String?

  /// IngressConfig for router to set up Ingress.
  ingressconfig: Ingressconfig?

  /// When function is exposed with Prefix based path, keepPrefix decides whether to keep or trim prefix
  /// in URL while invoking function.
  keepPrefix: Boolean?

  /// Use Methods instead of Method. This field is going to be deprecated in a future release HTTP method
  /// to access a function.
  method: String?

  /// HTTP methods to access a function
  methods: Listing<String>?

  /// Prefix with which functions are exposed. NOTE: Prefix takes precedence over URL/RelativeURL. Note
  /// that it does not treat slashes specially ("/foobar/" will be matched by the prefix "/foobar").
  prefix: String?

  /// RelativeURL is the exposed URL for external client to access a function with.
  relativeurl: String?
}

/// FunctionReference is a reference to the target function.
class Functionref {
  /// Function Reference by weight. this map contains function name as key and its weight as the value.
  /// This is for canary upgrade purpose.
  functionweights: Mapping<String, Int>?

  /// Name of the function.
  name: String

  /// Type indicates whether this function reference is by name or selector. For now, the only supported
  /// reference type is by "name". Future reference types: * Function by label or annotation * Branch or
  /// tag of a versioned function * A "rolling upgrade" from one version of a function to another
  /// Available value: - name - function-weights
  type: String
}

/// IngressConfig for router to set up Ingress.
class Ingressconfig {
  /// Annotations will be added to metadata when creating Ingress.
  annotations: Mapping<String, String>?

  /// Host is for ingress controller to apply rules. If host is empty or "*", the rule applies to all
  /// inbound HTTP traffic.
  host: String?

  /// Path is for path matching. The format of path depends on what ingress controller you used.
  path: String?

  /// TLS is for user to specify a Secret that contains TLS key and certificate. The domain name in the
  /// key and crt must match the value of Host field.
  tls: String?
}
